---
// TickerTape.astro
---
<div id="ticker-viewport" class="ticker-container border-b border-white/5 bg-[#0a0a0a] min-h-[72px]">
  <div id="tradingview-ticker-wrapper">
    </div>
</div>

<script is:inline>
  function loadTradingView() {
    const container = document.getElementById('tradingview-ticker-wrapper');
    if (!container || container.querySelector('script')) return;

    const script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js';
    script.async = true;
    script.innerHTML = JSON.stringify({
      "symbols": [
        { "proName": "FOREXCOM:SPXUSD", "title": "S&P 500" },
        { "proName": "FOREXCOM:NSXUSD", "title": "Nasdaq 100" },
        { "proName": "FX:EURUSD", "title": "EUR/USD" },
        { "proName": "BITSTAMP:BTCUSD", "title": "BTC/USD" },
        { "proName": "BITSTAMP:ETHUSD", "title": "ETH/USD" },
        { "proName": "OANDA:XAUUSD", "title": "Gold" }
      ],
      "showSymbolLogo": true,
      "colorTheme": "dark",
      "isTransparent": false,
      "displayMode": "adaptive",
      "locale": "en",
      "height": 72
    });
    container.appendChild(script);
  }

  // Use a safer loading trigger for Astro
  if (document.readyState === 'complete') {
    loadTradingView();
  } else {
    window.addEventListener('load', loadTradingView);
  }
</script>

<style>
  .ticker-container {
    height: 72px;
    overflow: hidden;
    /* This ensures CSS parser stays in its lane */
    display: block;
    width: 100%;
  }
</style>
