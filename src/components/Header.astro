---
// Header v2.0 â€“ Stable auth links via Astro redirects
---

<header id="site-header" class="border-b border-slate-900 bg-black/50 backdrop-blur-md sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">

    <!-- Logo -->
    <a href="/" class="text-xl font-black tracking-tighter text-white shrink-0">
      TRADE<span class="text-emerald-500">90</span>
    </a>

    <div class="flex items-center gap-4">

      <!-- Desktop Nav -->
      <nav class="hidden md:flex items-center gap-8 text-[10px] font-black uppercase tracking-[0.2em] mr-4">
        <a href="/" class="text-slate-400 hover:text-white transition-colors">Calculator</a>
        <a href="/blog" class="text-slate-400 hover:text-white transition-colors">Analysis</a>
      </nav>

      <!-- Desktop Auth -->
      <div class="hidden md:flex items-center gap-3">
        <a
          href="/join"
          class="px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest
                 bg-emerald-500 text-black hover:bg-emerald-400 transition"
        >
          Join Now
        </a>

        <a
          href="/login"
          class="px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest
                 border border-slate-700 text-slate-300 hover:text-white hover:border-slate-500 transition"
        >
          Login
        </a>
      </div>

      <!-- Mobile Menu -->
      <div class="relative">
        <button
          id="menu-toggle"
          aria-label="Toggle Menu"
          type="button"
          class="text-white p-2 hover:bg-slate-900 rounded-lg cursor-pointer bg-transparent border-none outline-none"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
               viewBox="0 0 24 24" fill="none" stroke="currentColor"
               stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" x2="21" y1="12" y2="12"></line>
            <line x1="3" x2="21" y1="6" y2="6"></line>
            <line x1="3" x2="21" y1="18" y2="18"></line>
          </svg>
        </button>

        <div
          id="mobile-menu"
          class="hidden absolute top-14 right-0 w-72 bg-slate-950 border border-slate-800 shadow-2xl rounded-2xl py-3 z-50 overflow-hidden"
        >
          <!-- Mobile Auth -->
          <div class="px-4 py-3 border-b border-slate-900/50 space-y-2">
            <a
              href="/join"
              class="block w-full text-center px-4 py-3 rounded-xl
                     bg-emerald-500 text-black text-[10px] font-black uppercase tracking-widest hover:bg-emerald-400 transition"
            >
              Join Now
            </a>

            <a
              href="/login"
              class="block w-full text-center px-4 py-3 rounded-xl
                     border border-slate-700 text-slate-300 text-[10px] font-black uppercase tracking-widest hover:text-white hover:border-slate-500 transition"
            >
              Login
            </a>

            <a
              href="/logout"
              class="block w-full text-center px-4 py-3 rounded-xl
                     text-rose-400 text-[10px] font-black uppercase tracking-widest hover:bg-slate-900 transition"
            >
              Logout
            </a>
          </div>

          <!-- Mobile Nav -->
          <a href="/" class="block px-6 py-4 text-[10px] font-black uppercase text-slate-300 hover:bg-slate-900 hover:text-emerald-500 transition border-b border-slate-900/50">Calculator</a>
          <a href="/blog" class="block px-6 py-4 text-[10px] font-black uppercase text-slate-300 hover:bg-slate-900 hover:text-emerald-500 transition border-b border-slate-900/50">Analysis</a>
          <a href="/about" class="block px-6 py-4 text-[10px] font-black uppercase text-slate-400 hover:bg-slate-900 transition border-b border-slate-900/50">About Framework</a>
          <a href="/contact" class="block px-6 py-4 text-[10px] font-black uppercase text-slate-400 hover:bg-slate-900 transition">Contact Support</a>
        </div>
      </div>
    </div>
  </div>
</header>

<script is:inline>
  const header = document.getElementById("site-header");
  const btn = header?.querySelector("#menu-toggle");
  const menu = header?.querySelector("#mobile-menu");

  if (btn && menu && header) {
    const toggleMenu = (e) => {
      e.preventDefault();
      e.stopPropagation();
      menu.classList.toggle("hidden");
    };

    btn.addEventListener("pointerdown", toggleMenu);
    btn.addEventListener("click", toggleMenu);

    menu.addEventListener("pointerdown", (e) => e.stopPropagation());
    menu.addEventListener("click", (e) => e.stopPropagation());

    document.addEventListener("pointerdown", (e) => {
      if (!header.contains(e.target)) menu.classList.add("hidden");
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") menu.classList.add("hidden");
    });

    menu.querySelectorAll("a").forEach((a) => {
      a.addEventListener("click", () => menu.classList.add("hidden"));
    });
  }
</script>