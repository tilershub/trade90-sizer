---
interface Props {
  title: string;
  excerpt: string;
  image: string;
  slug: string;
  date: string;
}

const { title, excerpt, image, slug, date } = Astro.props;

const assetOrigin = "https://trade90.ghost.io";

// Fix: If Ghost sends a tradeninety.com link, we swap it back to ghost.io
const cleanImage = image?.startsWith('http') 
  ? image.replace('https://tradeninety.com', assetOrigin).replace('https://www.tradeninety.com', assetOrigin)
  : `${assetOrigin}${image}`;
---

<article class="group flex flex-col bg-slate-900/40 rounded-2xl overflow-hidden border border-slate-900 hover:border-green-500/40 transition-all duration-500">
  {image && (
    <a href={`/blog/${slug}`} class="block aspect-video overflow-hidden border-b border-slate-900">
      <img 
        src={cleanImage} 
        alt={title}
        loading="lazy" 
        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-1000"
      />
    </a>
  )}

  <div class="p-6 flex flex-col flex-grow">
    <div class="flex items-center justify-between mb-3">
        <time class="text-[10px] text-green-500 font-mono uppercase tracking-[0.2em] font-bold">
          {new Date(date).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}
        </time>
    </div>
    
    <h3 class="text-lg font-bold text-white group-hover:text-green-400 transition-colors leading-tight mb-3">
      <a href={`/blog/${slug}`}>{title}</a>
    </h3>
    
    <p class="text-slate-400 text-sm line-clamp-2 leading-relaxed mb-6 italic">
      {excerpt}
    </p>

    <div class="mt-auto pt-4 border-t border-slate-800/50 flex items-center justify-between">
       <span class="text-[10px] text-slate-500 uppercase tracking-widest font-bold">Read Analysis â†’</span>
    </div>
  </div>
</article>
